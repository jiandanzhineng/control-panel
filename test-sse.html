<!DOCTYPE html>
<html>
<head>
    <title>SSEæµ‹è¯•</title>
</head>
<body>
    <h1>SSEè¿æ¥æµ‹è¯•</h1>
    <div id="status">è¿æ¥çŠ¶æ€: æœªè¿æ¥</div>
    <div id="messages"></div>

    <script>
        const deviceId = 'qiya001aabbcc';
        const url = `http://localhost:3000/api/devices/${deviceId}/monitor-stream`;
        
        console.log('å»ºç«‹SSEè¿æ¥åˆ°:', url);
        
        const eventSource = new EventSource(url);
        
        eventSource.onopen = () => {
            console.log('âœ… SSEè¿æ¥å·²å»ºç«‹');
            document.getElementById('status').textContent = 'è¿æ¥çŠ¶æ€: å·²è¿æ¥';
        };
        
        eventSource.onmessage = (event) => {
            console.log('ğŸ“¨ æ”¶åˆ°SSEæ¶ˆæ¯:', event.data);
            const messagesDiv = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.textContent = `${new Date().toLocaleTimeString()}: ${event.data}`;
            messagesDiv.appendChild(messageDiv);
        };
        
        eventSource.onerror = (error) => {
            console.error('âŒ SSEè¿æ¥é”™è¯¯:', error);
            document.getElementById('status').textContent = 'è¿æ¥çŠ¶æ€: é”™è¯¯';
        };
        
        // 10ç§’åå…³é—­è¿æ¥
        setTimeout(() => {
            console.log('ğŸ”Œ å…³é—­SSEè¿æ¥');
            eventSource.close();
            document.getElementById('status').textContent = 'è¿æ¥çŠ¶æ€: å·²å…³é—­';
        }, 10000);
    </script>
</body>
</html>